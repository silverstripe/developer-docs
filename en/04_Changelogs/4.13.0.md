---
title: 4.13.0 (unreleased)
---

# 4.13.0 (unreleased)

## Overview

- [Deprecated API (by module, alphabetically)](#deprecated-api)
- [Features and enhancements](#features-and-enhancements)

## Deprecated API (by module, alphabetically) {#deprecated-api}

### dnadesign/silverstripe-elemental

- Marked as deprecated class `DNADesign\Elemental\TopPage\TestState`. Will be removed without equivalent functionality to replace it in CMS 5.0.
- Marked as deprecated the following methods and they will be removed without equivalent functionality to replace it in CMS 5.0:
  - `DNADesign\Elemental\TopPage::getTopPageUpdate()`
  - `DNADesign\Elemental\TopPage::enableTopPageUpdate()`
  - `DNADesign\Elemental\TopPage::disableTopPageUpdate()`
  - `DNADesign\Elemental\TopPage::withTopPageUpdate()`

## Features and enhancements

### GridField pagination can respect canView permissions

Pagination in a `GridField` has traditionally given incorrect results if the user doesn't have sufficient permissions to view some of the records in the `GridField`. This is because permissions checks need to be done for _each_ record individually in PHP (it can't be done as part of the database query), which when you have tens of thousands of records can result in a serious performance hit.

This is still the default behaviour in CMS 4.13, but we've decided to let you make the judgment call yourself whether the performance hit is worth having correct pagination results. For some GridFields the `canView` check might be guaranteed to return true, so the performance hit wouldn't give you any value in return. For others, you might have a complex permission check and few enough records that it's worthwhile. You can make the call for what's right in your project, either globally or for each `GridField` independantly.

The new behaviour simply runs permission checks on all records before paginating, whereas the default behaviour runs the pagination first.

To enable the new behaviour globally, set [`GridFieldPaginator.default_paginate_after_canview`](api:SilverStripe\Forms\GridField\GridFieldPaginator::$default_paginate_after_canview) to true:

```yml
SilverStripe\Forms\GridField\GridFieldPaginator:
  default_paginate_after_canview: true
```

To enable the new behaviour for a specific gridfield, call [`setFilterAfterCanview()`](api:SilverStripe\Forms\GridField\GridFieldPaginator::setFilterAfterCanview()) on the `GridFieldPaginator` component:

```php
$gridField->getConfig()->getComponentByType(GridFieldPaginator::class)->setFilterAfterCanview(true);
```

[info]
This change also introduces a new [`GridField::getListForDisplay()`](api:SilverStripe\Forms\GridField\GridField::getListForDisplay()) method which returns the exact list which will be displayed in the gridfield. This is in contrast to [`GridField::getManipulatedList()`](api:SilverStripe\Forms\GridField\GridField::getManipulatedList()) which returns a list that is manipulated by some `GridField` components but has not had permission checks run.
[/info]
